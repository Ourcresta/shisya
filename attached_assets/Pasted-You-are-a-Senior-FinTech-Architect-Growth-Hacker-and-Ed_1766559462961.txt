You are a Senior FinTech Architect,
Growth Hacker,
and EdTech Platform Engineer.

Your task is to EXTEND the existing
â€œBuy Credits (â‚¹â‚¹â‚¹)â€ system
by adding:

1) Voucher Codes
2) Gift Credit Boxes

This must be secure, auditable,
and production-ready.

--------------------------------------------------
ğŸ¯ BUSINESS GOAL
--------------------------------------------------

â€¢ Increase conversions
â€¢ Enable gifting learning
â€¢ Enable promotions & referrals
â€¢ Create festive / corporate sales use-cases

--------------------------------------------------
ğŸ“ ROUTES (LOCK)
--------------------------------------------------

/shishya/wallet
/shishya/wallet/buy
/shishya/wallet/redeem
/shishya/wallet/gift

--------------------------------------------------
ğŸª™ WALLET ENHANCEMENT
--------------------------------------------------

Wallet now supports:
â€¢ Paid Credits
â€¢ Voucher Credits
â€¢ Gift Credits

Transaction source must track:
â€¢ Recharge
â€¢ Voucher
â€¢ Gift Received

--------------------------------------------------
ğŸŸï¸ PART 1 â€” VOUCHER SYSTEM
--------------------------------------------------

### Voucher Concept
â€¢ Admin-generated codes
â€¢ Fixed points or bonus %
â€¢ Limited usage
â€¢ Optional expiry

Examples:
â€¢ WELCOME500 â†’ +500 points
â€¢ NEWYEAR10 â†’ +10% bonus
â€¢ FESTIVE1000 â†’ +1000 points

--------------------------------------------------
### Voucher Redeem UI

Location:
â€¢ Wallet page
â€¢ Redeem section

UI:
â€¢ Input: Voucher Code
â€¢ Button: Redeem
â€¢ Show success/failure toast

--------------------------------------------------
### Voucher Validation Rules

âœ” Code exists
âœ” Not expired
âœ” Not already redeemed by user
âœ” Usage limit not exceeded

--------------------------------------------------
### Voucher Credit Logic

On success:
â€¢ Create CREDIT transaction
â€¢ source = "Voucher"
â€¢ points added
â€¢ mark voucher as redeemed

--------------------------------------------------
ğŸ“¦ PART 2 â€” GIFT CREDIT BOXES
--------------------------------------------------

### Gift Box Concept

A Gift Box is a prepaid credit pack
that can be sent to another user.

Examples:
ğŸ Learning Starter â€“ 500 Points
ğŸ Skill Booster â€“ 1000 Points
ğŸ Pro Career Box â€“ 2500 Points

--------------------------------------------------
### Gift Purchase Flow

1. Buyer selects Gift Box
2. Pays via Razorpay
3. Enters recipient email / phone
4. Gift created in backend
5. Gift notification sent

--------------------------------------------------
### Gift Claim Flow

Recipient:
â€¢ Sees â€œYou received a Gift ğŸ‰â€
â€¢ Clicks Claim
â€¢ Points added to wallet
â€¢ Gift marked as claimed

--------------------------------------------------
ğŸ“Š GIFT STATUS STATES
--------------------------------------------------

â€¢ CREATED
â€¢ SENT
â€¢ CLAIMED
â€¢ EXPIRED

--------------------------------------------------
ğŸ§  DATA MODELS
--------------------------------------------------

Voucher:
â€¢ code
â€¢ points / bonusPercent
â€¢ expiryDate
â€¢ maxUsage
â€¢ usedCount
â€¢ isActive

VoucherRedemption:
â€¢ userId
â€¢ voucherCode
â€¢ redeemedAt

GiftBox:
â€¢ id
â€¢ senderId
â€¢ recipientContact
â€¢ points
â€¢ paymentId
â€¢ status
â€¢ createdAt
â€¢ claimedAt

WalletTransaction (extend):
â€¢ type: CREDIT
â€¢ source: Recharge | Voucher | Gift
â€¢ referenceId

--------------------------------------------------
âš™ï¸ BACKEND APIs
--------------------------------------------------

POST /wallet/redeem-voucher
POST /wallet/create-gift
POST /wallet/claim-gift
GET  /wallet/gifts
GET  /wallet/vouchers (public metadata)

--------------------------------------------------
ğŸ” SECURITY & ABUSE PREVENTION
--------------------------------------------------

âœ” One voucher per user (configurable)
âœ” Server-side validation only
âœ” Rate-limit voucher attempts
âœ” Prevent self-gifting exploit
âœ” Immutable transaction ledger

--------------------------------------------------
ğŸ¨ UX RULES
--------------------------------------------------

â€¢ Festive, celebratory UI
â€¢ Clear credit source labels
â€¢ Confetti / success animation on gift claim
â€¢ Always show updated balance

--------------------------------------------------
ğŸ§ª TEST CASES (MANDATORY)
--------------------------------------------------

âœ” Voucher redeems only once
âœ” Expired voucher rejected
âœ” Gift credited only once
âœ” Wrong user cannot claim gift
âœ” Wallet balance updates correctly
âœ” Payment failure creates no gift
âœ” History logs source correctly

--------------------------------------------------
ğŸš« DO NOT
--------------------------------------------------

âœ— Do not allow manual wallet edits
âœ— Do not allow negative credits
âœ— Do not hide source of credits
âœ— Do not allow voucher reuse

--------------------------------------------------
âœ… FINAL PRODUCT RESULT
--------------------------------------------------

Shishya now supports:
â€¢ Paid credits
â€¢ Free promotional credits
â€¢ Gifted learning
â€¢ Corporate & festive sales
â€¢ Viral referrals
